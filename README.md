# Проект "Базы данных"

Проект посвящен созданию, наполнению и работе с базами данных в MySQL. Его цель — закрепление знаний, полученных в рамках курса по базам данных.

### В проекте представлены четыре базы данных:

Транспортные средства.
Автомобильные гонки.
Бронирование отелей.
Структура организации.
Каждая база данных включает этапы создания таблиц, наполнения их данными и решения задач различной сложности. Для каждой базы данных предоставлены SQL-скрипты, которые создают таблицы и заполняют их тестовыми данными.

## База данных 1. Транспортные средства.
Описание структуры базы данных

База данных состоит из четырех таблиц, которые хранят информацию о транспортных средствах:

Таблица Vehicle
Цель: Хранение общей информации о производителях и моделях транспортных средств.
Поля:
maker (VARCHAR): Название производителя.
model (VARCHAR): Название модели (первичный ключ).
type (ENUM): Тип транспортного средства ('Car', 'Motorcycle', 'Bicycle').
Таблица Car
Цель: Хранение информации о легковых автомобилях.
Поля:
vin (VARCHAR): Уникальный идентификатор автомобиля (первичный ключ).
model (VARCHAR): Название модели (внешний ключ на таблицу Vehicle).
engine_capacity (DECIMAL): Объем двигателя в литрах.
horsepower (INT): Мощность двигателя в лошадиных силах.
price (DECIMAL): Цена автомобиля.
transmission (ENUM): Тип трансмиссии ('Automatic', 'Manual').
Таблица Motorcycle
Цель: Хранение информации о мотоциклах.
Поля:
vin (VARCHAR): Уникальный идентификатор мотоцикла (первичный ключ).
model (VARCHAR): Название модели (внешний ключ на таблицу Vehicle).
engine_capacity (DECIMAL): Объем двигателя в литрах.
horsepower (INT): Мощность двигателя.
price (DECIMAL): Цена мотоцикла.
type (ENUM): Тип мотоцикла ('Sport', 'Cruiser', 'Touring').
Таблица Bicycle
Цель: Хранение информации о велосипедах.
Поля:
serial_number (VARCHAR): Уникальный серийный номер (первичный ключ).
model (VARCHAR): Название модели (внешний ключ на таблицу Vehicle).
gear_count (INT): Количество передач.
price (DECIMAL): Цена велосипеда.
type (ENUM): Тип велосипеда ('Mountain', 'Road', 'Hybrid').
Взаимосвязи

Таблицы Car, Motorcycle и Bicycle связаны с таблицей Vehicle через поле model, что обеспечивает целостность данных.
Каждая модель в таблицах Car, Motorcycle и Bicycle должна существовать в таблице Vehicle.
Подготовительный этап

Создать базу данных vehicles в графическом интерфейсе.
Создать таблицы, выполнив скрипт databases/vehicles/V1__create_tables.sql.
Заполнить таблицы данными, выполнив скрипт databases/vehicles/V2__insert_data.sql.



#### Задача 1:

Найдите производителей (maker) и модели всех мотоциклов, которые имеют мощность более 150 лошадиных сил, стоят менее 20 тысяч долларов и являются спортивными (тип Sport). Также отсортируйте результаты по мощности в порядке убывания.

- Результат работы решения:

  ![alt text](/image/db.1.1.jpg)

#### Задача 2:

Найти информацию о производителях и моделях различных типов транспортных средств (автомобили, мотоциклы и велосипеды), которые соответствуют заданным критериям.

Автомобили:
Извлечь данные о всех автомобилях, которые имеют:

Мощность двигателя более 150 лошадиных сил.
Объем двигателя менее 3 литров.
Цену менее 35 тысяч долларов.
В выводе должны быть указаны производитель (maker), номер модели (model), мощность (horsepower), объем двигателя (engine_capacity) и тип транспортного средства, который будет обозначен как Car.

Мотоциклы:
Извлечь данные о всех мотоциклах, которые имеют:

Мощность двигателя более 150 лошадиных сил.
Объем двигателя менее 1,5 литров.
Цену менее 20 тысяч долларов.
В выводе должны быть указаны производитель (maker), номер модели (model), мощность (horsepower), объем двигателя (engine_capacity) и тип транспортного средства, который будет обозначен как Motorcycle.

Велосипеды:
Извлечь данные обо всех велосипедах, которые имеют:

Количество передач больше 18.
Цену менее 4 тысяч долларов.
В выводе должны быть указаны производитель (maker), номер модели (model), а также NULL для мощности и объема двигателя, так как эти характеристики не применимы для велосипедов. Тип транспортного средства будет обозначен как Bicycle.

Сортировка:
Результаты должны быть объединены в один набор данных и отсортированы по мощности в порядке убывания. Для велосипедов, у которых нет значения мощности, они будут располагаться внизу списка.

- Результат работы решения:

  ![alt text](/image/db.1.2.jpg)

## База данных 2 . Автомобильные гонки



#### Задача 1:

Определить, какие автомобили из каждого класса имеют наименьшую среднюю позицию в гонках, и вывести информацию о каждом таком автомобиле для данного класса, включая его класс, среднюю позицию и количество гонок, в которых он участвовал. Также отсортировать результаты по средней позиции.

- Результат работы решения:

  ![alt text](/image/db.2.1.jpg)

#### Задача 2:

Определить автомобиль, который имеет наименьшую среднюю позицию в гонках среди всех автомобилей, и вывести информацию об этом автомобиле, включая его класс, среднюю позицию, количество гонок, в которых он участвовал, и страну производства класса автомобиля. Если несколько автомобилей имеют одинаковую наименьшую среднюю позицию, выбрать один из них по алфавиту (по имени автомобиля).

- Результат работы решения:

  ![alt text](/image/db.2.2.jpg)

#### Задача 3:

Определить классы автомобилей, которые имеют наименьшую среднюю позицию в гонках, и вывести информацию о каждом автомобиле из этих классов, включая его имя, среднюю позицию, количество гонок, в которых он участвовал, страну производства класса автомобиля, а также общее количество гонок, в которых участвовали автомобили этих классов. Если несколько классов имеют одинаковую среднюю позицию, выбрать все из них.

- Результат работы решения:

  ![alt text](/image/db.2.3.jpg)

#### Задача 4:

Определить, какие автомобили имеют среднюю позицию лучше (меньше) средней позиции всех автомобилей в своем классе (то есть автомобилей в классе должно быть минимум два, чтобы выбрать один из них). Вывести информацию об этих автомобилях, включая их имя, класс, среднюю позицию, количество гонок, в которых они участвовали, и страну производства класса автомобиля. Также отсортировать результаты по классу и затем по средней позиции в порядке возрастания.

- Результат работы решения:

  ![alt text](/image/db.2.4.jpg)

#### Задача 5:

Определить, какие классы автомобилей имеют наибольшее количество автомобилей с низкой средней позицией (больше 3.0) и вывести информацию о каждом автомобиле из этих классов, включая его имя, класс, среднюю позицию, количество гонок, в которых он участвовал, страну производства класса автомобиля, а также общее количество гонок для каждого класса. Отсортировать результаты по количеству автомобилей с низкой средней позицией.

- Результат работы решения:

  ![alt text](/image/db.2.5.jpg)

## База данных 3. Бронирование отелей
Описание структуры базы данных

База данных состоит из четырех таблиц:

Таблица Hotel
Цель: Хранение информации о гостиницах.
Поля:
ID_hotel (INT): Уникальный идентификатор гостиницы.
name (VARCHAR): Название гостиницы.
location (VARCHAR): Местоположение.
Таблица Room
Цель: Хранение информации о номерах.
Поля:
ID_room (INT): Уникальный идентификатор номера.
ID_hotel (INT): Идентификатор гостиницы (внешний ключ).
room_type (ENUM): Тип номера ('Single', 'Double', 'Suite').
price (DECIMAL): Цена за ночь.
capacity (INT): Вместимость номера.
Таблица Customer
Цель: Хранение информации о клиентах.
Поля:
ID_customer (INT): Уникальный идентификатор клиента.
name (VARCHAR): Имя клиента.
email (VARCHAR): Электронная почта.
phone (VARCHAR): Номер телефона.
Таблица Booking
Цель: Хранение информации о бронированиях.
Поля:
ID_booking (INT): Уникальный идентификатор бронирования.
ID_room (INT): Идентификатор номера (внешний ключ).
ID_customer (INT): Идентификатор клиента (внешний ключ).
check_in_date (DATE): Дата заезда.
check_out_date (DATE): Дата выезда.
Подготовительный этап

Создать базу данных hotels_booking в графическом интерфейсе.
Создать таблицы, выполнив скрипт databases/hotels_booking/V1__create_tables.sql.
Заполнить таблицы данными, выполнив скрипт databases/hotels_booking/V2__insert_data.sql.



#### Задача 1:

Определить, какие клиенты сделали более двух бронирований в разных отелях, и вывести информацию о каждом таком клиенте, включая его имя, электронную почту, телефон, общее количество бронирований, а также список отелей, в которых они бронировали номера (объединенные в одно поле через запятую с помощью CONCAT). Также подсчитать среднюю длительность их пребывания (в днях) по всем бронированиям. Отсортировать результаты по количеству бронирований в порядке убывания.

- Результат работы решения:

  ![alt text](/image/db.3.1.jpg)

#### Задача 2:

Необходимо провести анализ клиентов, которые сделали более двух бронирований в разных отелях и потратили более 500 долларов на свои бронирования. Для этого:

Определить клиентов, которые сделали более двух бронирований и забронировали номера в более чем одном отеле. Вывести для каждого такого клиента следующие данные: ID_customer, имя, общее количество бронирований, общее количество уникальных отелей, в которых они бронировали номера, и общую сумму, потраченную на бронирования.
Также определить клиентов, которые потратили более 500 долларов на бронирования, и вывести для них ID_customer, имя, общую сумму, потраченную на бронирования, и общее количество бронирований.
В результате объединить данные из первых двух пунктов, чтобы получить список клиентов, которые соответствуют условиям обоих запросов. Отобразить поля: ID_customer, имя, общее количество бронирований, общую сумму, потраченную на бронирования, и общее количество уникальных отелей.
Результаты отсортировать по общей сумме, потраченной клиентами, в порядке возрастания.

- Результат работы решения:

  ![alt text](/image/db.3.2.jpg)

#### Задача 3:

Вам необходимо провести анализ данных о бронированиях в отелях и определить предпочтения клиентов по типу отелей. Для этого выполните следующие шаги:

Категоризация отелей.
Определите категорию каждого отеля на основе средней стоимости номера:

«Дешевый»: средняя стоимость менее 175 долларов.
«Средний»: средняя стоимость от 175 до 300 долларов.
«Дорогой»: средняя стоимость более 300 долларов.
Анализ предпочтений клиентов.
Для каждого клиента определите предпочитаемый тип отеля на основании условия ниже:

Если у клиента есть хотя бы один «дорогой» отель, присвойте ему категорию «дорогой».
Если у клиента нет «дорогих» отелей, но есть хотя бы один «средний», присвойте ему категорию «средний».
Если у клиента нет «дорогих» и «средних» отелей, но есть «дешевые», присвойте ему категорию предпочитаемых отелей «дешевый».
Вывод информации.
Выведите для каждого клиента следующую информацию:

ID_customer: уникальный идентификатор клиента.
name: имя клиента.
preferred_hotel_type: предпочитаемый тип отеля.
visited_hotels: список уникальных отелей, которые посетил клиент.
Сортировка результатов.
Отсортируйте клиентов так, чтобы сначала шли клиенты с «дешевыми» отелями, затем со «средними» и в конце — с «дорогими».

- Результат работы решения:

  ![alt text](/image/db.3.3.jpg)

## База данных 4. Структура организации

База данных 4: Структура организации

Описание структуры базы данных

База данных состоит из пяти таблиц:

Таблица Departments
Цель: Хранение информации о департаментах.
Поля:
DepartmentID (INT): Уникальный идентификатор департамента.
DepartmentName (VARCHAR): Название департамента.
Таблица Roles
Цель: Хранение информации о ролях.
Поля:
RoleID (INT): Уникальный идентификатор роли.
RoleName (VARCHAR): Название роли.
Таблица Employees
Цель: Хранение информации о сотрудниках.
Поля:
EmployeeID (INT): Уникальный идентификатор сотрудника.
Name (VARCHAR): Имя сотрудника.
Position (VARCHAR): Должность.
ManagerID (INT): Идентификатор менеджера.
DepartmentID (INT): Идентификатор департамента.
RoleID (INT): Идентификатор роли.
Таблица Projects
Цель: Хранение информации о проектах.
Поля:
ProjectID (INT): Уникальный идентификатор проекта.
ProjectName (VARCHAR): Название проекта.
StartDate (DATE): Дата начала.
EndDate (DATE): Дата окончания.
DepartmentID (INT): Идентификатор департамента.
Таблица Tasks
Цель: Хранение информации о задачах.
Поля:
TaskID (INT): Уникальный идентификатор задачи.
TaskName (VARCHAR): Название задачи.
AssignedTo (INT): Идентификатор сотрудника.
ProjectID (INT): Идентификатор проекта.
Подготовительный этап

Создать базу данных company_structure в графическом интерфейсе.
Создать таблицы, выполнив скрипт databases/company_structure/V1__create_tables.sql.
Заполнить таблицы данными, выполнив скрипт databases/company_structure/V2__insert_data.sql.

#### Задача 1:

Найти всех сотрудников, подчиняющихся Ивану Иванову (с EmployeeID = 1), включая их подчиненных и подчиненных подчиненных. Для каждого сотрудника вывести следующую информацию:

EmployeeID: идентификатор сотрудника.
Имя сотрудника.
ManagerID: Идентификатор менеджера.
Название отдела, к которому он принадлежит.
Название роли, которую он занимает.
Название проектов, к которым он относится (если есть, конкатенированные в одном столбце через запятую).
Название задач, назначенных этому сотруднику (если есть, конкатенированные в одном столбце через запятую).
Если у сотрудника нет назначенных проектов или задач, отобразить NULL.

- Результат работы решения:

  ![alt text](/image/db.4.1.jpg)

  - и др., весь ответ не влез.

#### Задача 2:

Найти всех сотрудников, подчиняющихся Ивану Иванову с EmployeeID = 1, включая их подчиненных и подчиненных подчиненных. Для каждого сотрудника вывести следующую информацию:

EmployeeID: идентификатор сотрудника.
Имя сотрудника.
Идентификатор менеджера.
Название отдела, к которому он принадлежит.
Название роли, которую он занимает.
Название проектов, к которым он относится (если есть, конкатенированные в одном столбце).
Название задач, назначенных этому сотруднику (если есть, конкатенированные в одном столбце).
Общее количество задач, назначенных этому сотруднику.
Общее количество подчиненных у каждого сотрудника (не включая подчиненных их подчиненных).
Если у сотрудника нет назначенных проектов или задач, отобразить NULL.

- Результат работы решения:

  ![alt text](/image/db.4.2.jpg)

  - и др., весь ответ не влез.

#### Задача 3:

Найти всех сотрудников, которые занимают роль менеджера и имеют подчиненных (то есть число подчиненных больше 0). Для каждого такого сотрудника вывести следующую информацию:

EmployeeID: идентификатор сотрудника.
Имя сотрудника.
Идентификатор менеджера.
Название отдела, к которому он принадлежит.
Название роли, которую он занимает.
Название проектов, к которым он относится (если есть, конкатенированные в одном столбце).
Название задач, назначенных этому сотруднику (если есть, конкатенированные в одном столбце).
Общее количество подчиненных у каждого сотрудника (включая их подчиненных).
Если у сотрудника нет назначенных проектов или задач, отобразить NULL.

- Результат работы решения:

  ![alt text](/image/db.4.3.jpg)
